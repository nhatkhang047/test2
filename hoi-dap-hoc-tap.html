<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hỏi Đáp Học Tập</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      .navbar {
        background-color: #28a745 !important; /* Tông màu navbar */
      }
      .navbar-brand,
      .nav-link {
        color: white !important;
      }
      .nav-link:hover,
      .nav-link.active {
        color: #d4f3d4 !important; /* Màu sáng khi hover */
      }
      .question-card {
        border-left: 4px solid #4caf50;
        background-color: #f9f9f9;
      }
      .btn-success {
        background-color: #4caf50;
        border-color: #4caf50;
      }
      .btn-success:hover {
        background-color: #388e3c;
        border-color: #388e3c;
      }
      #questions-container {
        max-height: 500px; /* Giới hạn chiều cao */
        overflow-y: auto; /* Tạo thanh cuộn nếu danh sách dài */
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Quản lý điểm</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-5">
            <li class="nav-item">
              <a class="nav-link" href="nhap-diem.html">Nhập điểm</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="diem-sv.html">Xem điểm</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="phuc-khao.html">Phúc khảo</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="hoi-dap-hoc-tap.html"
                >Hỏi đáp học tập</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Main content -->
    <div class="container my-5">
      <h2 class="text-center">Hỏi Đáp Học Tập</h2>

      <!-- Form đặt câu hỏi -->
      <div class="card my-4 p-4 shadow">
        <h5 class="text-success">Đặt Câu Hỏi</h5>
        <form id="question-form">
          <div class="mb-3">
            <label for="name" class="form-label">Họ và tên:</label>
            <input
              type="text"
              id="name"
              class="form-control"
              placeholder="Nhập tên của bạn"
              required
            />
          </div>

          <div class="mb-3">
            <label for="question" class="form-label">Câu hỏi:</label>
            <textarea
              id="question"
              class="form-control"
              rows="4"
              placeholder="Nhập câu hỏi của bạn"
              required
            ></textarea>
          </div>
          <button type="submit" class="btn btn-success">Gửi câu hỏi</button>
        </form>
      </div>

      <div class="d-flex mt-5">
        <!-- Danh sách câu hỏi -->
        <h5 class="text-success me-5">Câu Hỏi Mới Nhất</h5>
        <!-- Thêm ô tìm kiếm -->
        <div class="">
          <div class="input-group">
            <input
              type="text"
              id="search-input"
              class="form-control"
              placeholder="Tìm kiếm câu hỏi..."
            />
            <button id="search-btn" class="btn btn-success">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </div>

      <div id="questions-container">
        <div class="card question-card my-3 p-3">
          <h6 class="text-primary">Nguyễn Văn A</h6>
          <p><strong>Hỏi:</strong> Làm thế nào để học tốt môn Toán rời rạc?</p>
          <p>
            <strong>Trả lời:</strong> Bạn nên làm bài tập thường xuyên, đọc tài
            liệu và tham gia các nhóm học tập.
          </p>
          <button
            class="btn btn-success btn-sm"
            onclick="toggleAnswerBox(this)"
          >
            Trả lời
          </button>
          <div class="answer-box" style="display: none">
            <textarea
              class="form-control"
              rows="3"
              placeholder="Nhập câu trả lời"
            ></textarea>
            <button class="btn btn-success mt-2" onclick="submitAnswer(this)">
              Gửi câu trả lời
            </button>
          </div>
        </div>
        <div class="card question-card my-3 p-3">
          <h6 class="text-primary">Trần Thị B</h6>
          <p>
            <strong>Hỏi:</strong> Có sách nào hay về lập trình Python không?
          </p>
          <p>
            <strong>Trả lời:</strong> Bạn có thể tham khảo sách "Automate the
            Boring Stuff with Python" hoặc "Python Crash Course".
          </p>
          <button class="btn btn-success btn-sm" onclick="toggleAnswerBox(this)">Trả lời</button>
          <div class="answer-box" style="display: none;">
            <textarea class="form-control " rows="3" placeholder="Nhập câu trả lời"></textarea>
            <button class="btn btn-success mt-2" onclick="submitAnswer(this)">Gửi câu trả lời</button>
          </div>
        </div>
        <div class="card question-card my-3 p-3">
          <h6 class="text-primary">Lê Văn C</h6>
          <p>
            <strong>Hỏi:</strong> Làm sao để cải thiện kỹ năng thuyết trình?
          </p>
          <p>
            <strong>Trả lời:</strong> Hãy luyện tập trước gương, tham gia các
            câu lạc bộ thuyết trình, và xem các video diễn thuyết hay.
          </p>
          <button class="btn btn-success btn-sm" onclick="toggleAnswerBox(this)">Trả lời</button>
          <div class="answer-box" style="display: none;">
            <textarea class="form-control " rows="3" placeholder="Nhập câu trả lời"></textarea>
            <button class="btn btn-success mt-2" onclick="submitAnswer(this)">Gửi câu trả lời</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script -->
    <script>
      document
        .getElementById("question-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const name = document.getElementById("name").value;
          const question = document.getElementById("question").value;

          // Thêm câu hỏi mới vào đầu danh sách
          const questionsContainer = document.getElementById(
            "questions-container"
          );
          questionsContainer.insertAdjacentHTML("afterbegin", newQuestion);

          // Xóa dữ liệu form
          document.getElementById("question-form").reset();
        });

      const searchInput = document.getElementById("name");
      // Đặt con trỏ vào ô đầu khi trang tải
      searchInput.focus();

      // Bôi đen nội dung khi người dùng bấm vào bất kỳ ô nhập liệu nào
      document
        .querySelectorAll("input, textarea")
        .forEach(function (inputField) {
          inputField.addEventListener("focus", function () {
            this.select(); // Bôi đen toàn bộ nội dung trong ô nhập liệu
          });
        });

      // Tìm kiếm và tô đen từ khóa
      let currentMatchIndex = -1;
      let matches = [];

      document
        .getElementById("search-btn")
        .addEventListener("click", function () {
          const searchInput = document
            .getElementById("search-input")
            .value.trim();
          const questionsContainer = document.getElementById(
            "questions-container"
          );
          const questions =
            questionsContainer.querySelectorAll(".question-card");

          // Reset các kết quả cũ
          questions.forEach((question) => {
            question.innerHTML = question.innerHTML.replace(
              /<mark>|<\/mark>/g,
              ""
            );
          });
          matches = [];
          currentMatchIndex = -1;

          if (searchInput !== "") {
            // Tìm từ khóa trong các câu hỏi
            questions.forEach((question, index) => {
              if (
                question.innerText
                  .toLowerCase()
                  .includes(searchInput.toLowerCase())
              ) {
                matches.push({ question, index });
                question.innerHTML = question.innerHTML.replace(
                  new RegExp(searchInput, "gi"),
                  (match) => `<mark>${match}</mark>`
                );
              }
            });
          }

          // Nhảy đến kết quả đầu tiên nếu tìm thấy
          if (matches.length > 0) {
            currentMatchIndex = 0;
            matches[currentMatchIndex].question.scrollIntoView({
              behavior: "smooth",
            });
          } else {
            alert("Không tìm thấy kết quả nào.");
          }
        });

      // Điều hướng giữa các kết quả tìm kiếm bằng phím Enter
      document.addEventListener("keydown", function (e) {
        if (e.key === "Enter" && matches.length > 0) {
          e.preventDefault();

          // Xóa highlight của kết quả hiện tại
          matches[currentMatchIndex].question.style.backgroundColor = "";

          // Chuyển sang kết quả tiếp theo
          currentMatchIndex = (currentMatchIndex + 1) % matches.length;
          matches[currentMatchIndex].question.scrollIntoView({
            behavior: "smooth",
          });
          matches[currentMatchIndex].question.style.backgroundColor = "#f0f8ff"; // Đổi màu highlight
        }
      });

      // Hàm để thêm câu hỏi mới
      document
        .getElementById("question-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const name = document.getElementById("name").value;
          const question = document.getElementById("question").value;

          // Tạo phần tử câu hỏi mới
          const newQuestion = `
          <div class="card question-card my-3 p-3">
            <h6 class="text-primary">${name}</h6>
            <p><strong>Hỏi:</strong> ${question}</p>
            <button class="btn btn-success btn-sm" onclick="toggleAnswerBox(this)">Trả lời</button>
            <div class="answer-box" style="display: none;">
              <textarea class="form-control " rows="3" placeholder="Nhập câu trả lời"></textarea>
              <button class="btn btn-success mt-2" onclick="submitAnswer(this)">Gửi câu trả lời</button>
            </div>
          </div>
        `;

          // Thêm câu hỏi mới vào danh sách
          const questionsContainer = document.getElementById(
            "questions-container"
          );
          questionsContainer.insertAdjacentHTML("afterbegin", newQuestion);

          // Xóa dữ liệu form
          document.getElementById("question-form").reset();
        });

      // Hàm để hiển thị hoặc ẩn khung trả lời
      function toggleAnswerBox(button) {
        const answerBox = button.nextElementSibling;
        answerBox.style.display =
          answerBox.style.display === "none" ? "block" : "none";

        // Focus vào textarea khi hiển thị khung trả lời
        if (answerBox.style.display === "block") {
          const textarea = answerBox.querySelector("textarea");
          textarea.focus(); // Focus vào textarea
        }
      }

      // Hàm để gửi câu trả lời và hiển thị phía dưới câu hỏi
      function submitAnswer(button) {
        const answerBox = button.closest(".answer-box");
        const textarea = answerBox.querySelector("textarea");
        const answerText = textarea.value.trim(); // Lấy nội dung từ textarea

        if (answerText !== "") {
          const questionCard = button.closest(".question-card"); // Lấy thẻ card chứa câu hỏi
          const answerParagraph = document.createElement("p");
          answerParagraph.innerHTML = `<strong>Trả lời:</strong> ${answerText}`;

          // Thêm câu trả lời vào sau câu hỏi
          const questionText = questionCard.querySelector("p");
          questionCard.insertBefore(answerParagraph, questionText.nextSibling); // Thêm câu trả lời vào sau câu hỏi

          // Ẩn khung nhập trả lời và xóa nội dung trong textarea
          answerBox.style.display = "none"; // Ẩn khung nhập trả lời
          textarea.value = ""; // Xóa nội dung trong textarea
        } else {
          alert("Vui lòng nhập câu trả lời!");
        }
      }
    </script>
  </body>
</html>
